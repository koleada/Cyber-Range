**Active Directory Initial Attack Vectors**
    - LLMNR Poisoning
         - Responder
         - Understanding when LLMNR/NBT-NS/mDNS are used
         - Understanding what causes Responder to actually get a hit
         - Cracking hashes
         - LLMNR, NBT-NS, and NTLM are ALL enabled by default on Windows machines
         - LLMNR poisoning coercion techniques via different vulnerabilities (require credentials)
           
    - SMB Relay
       - What SMB signing is and why it is so important
       - How to find machines without SMB signing enabled
       - ntlmrelayx with responder
       - Ensure signing is enabled on all devices
       - The importance of following least privilege to mitigate damage if this attack is pulled off
         
    - IPv6 DNS Takeover (this is mysecond favorite active directory exploit)
        - IPv6 DNS requests are often generated during normal authentication flows involving SMB, LDAP, HTTP, or RPC
        - IPv6 is preferred by Windows, but usually not configured in a network
        - An attacker on the network can respond to the IPv6 DNS requests and specify their own IP, resulting in the client machine authenticating to the specified IP
        - Must require signing on SMB and LDAP
        - Must put very specific firewall rules in place to block IPv6 requests on certain protocols
          
    - Passback Attacks
        - How to identify IoT devices on a network via host scanning and fingerprinting
        - Common ways to get access to IoT devices (default credentials, known code execution vulnerabilities, etc)
        - Understanding that many IoT devices do outbound authentication to a domain controller via LDAP or to access a file share, email server, or cloud infrastructure
        - Understanding that changing the specified IP address to the domain controller, file share server, etc can allow us to capture the printer credentials by hosting our own server
          
 **Active Directory Initial Enumeration:**
   - Host Discovery
       - ICMP scans using nmap
       - ARP scans to find IoT devices
       - Netexec host discovery features
         
   - Finding Domain Controller IPs
       - Could simply be found with netexec
       - If DHCP is enabled on the network, we will see the domain name and the DC IP in /etc/resolv.conf
       - Reverse DNS lookups to get the DC hostname
       - Using the dig utility to get all DC IPs, provided we know the domain name
       - Traffic sniffing to potentially determine the DC IP
         
   - LDAP Enumeration
        - Using ldapdomaindump to check for anonymous bind and hopefully gain some information, and potentially enumerate certificate templates too
        - Using nmap's built-in LDAP scripts and the ldapsearch tool
          
   - SMB Enumeration
       - Checking if SYSVOL share is publicly accessible (uncommon but could lead to a quick win) GPP XML files often contain the cPassword field and are easy to decrypt
       - Using nmap or smbmap to enumerate shares on specific machines or IP ranges
       - Using netexec or similar tooling to find anonymous and guest accessible shares
         
   -  User enumeration
         - Looking for anonymous RPC bind to enumerate usernames using the netexec tool is best because it checks for domain enumeration RPCs along withother methods
         - RID brute forcing
         - Kerberos user enumeration (wordlist needed, but can be very useful if there is a standardized username scheme or with custom wordlists, potentially made with publicly accessible emails, etc, lots of ideas for custom wordlists)
           
 *Active Directory Post Compromise:*
   - Post Compromise Enumeration
       - Using ldapdomaindump to grab a ton of information about the AD environment
       - Using Bloodhound to dump Active Directory data, visualize the data in a graph, and query the data we gather
     
   - Authentication Coercion
       - Finding RPC endpoints with rpcdump
       - Standing up a server to capture coerced authentication
       - Using tooling to programmatically attempt to coerce authentication via known RPC pathways (PetitPotam, PrinterBug, etc)
        
    - Lateral Movement
         - Pass the password or pass the hash using netexec or similar tooling
               - netexec makes it super easy to test a credential on a wide range of machines very quickly
               - We want to try this on many different protocols like LDAP, SMB, RPC, RDP, HTTP, WinRM, depending on what were passing
         - Pass the ticket (a lot harder to dump the LSASS than to get NTLM hashes, but stilla  potential vector, albeit maybe later on in the engagement), mostly on the same protocols, but a couple additional ones too
           
    - Gaining More Passwords
        - secretsdump.py - attempts to dump a ton of information off of machines (goal is to be able to dump NTDS.dit, which requires domain admin privileges by default)
        - Mimikatz - super important, need SYSTEM or local admin, but it dumps the LSASS, which allows us to perform pass the ticket attacks, which is a huge step to domain admin
        - cPassword credential harvesting - this was patched a while ago, but unless the files were deleted post-patch, they will remain on the machine, always worth checking this, can be done real fast with Metasploit or similar tooling
        - LNK File Watering Hole
            - Create a malicious file that, when clicked, will send authentication to an IP of our choosing (just requests a share on our attacker's IP; this can be made with a couple of lines of PowerShell)
            - Place a malicious file into a file in a share that gets a lot of traffic, run an SMB server (like Responder) that will capture the authentication attempt when the file is clicked
        - Kerberoasting
            - Attempting to get all SPNs on the domain and then request a TGS for each
            - Cracking the TGS offline in hopes of getting a cleartext password to be passed
            - How Kerberos works under the hood
      
    - Windows Privilege Escalation (super important to gain system on a machine so we can dump LSASS, SAM, etc)
       -  winPEAS to get an initial outline of what techniques are most likely to work on a specific machine
       - Certificate Templates (This is my favorite AD exploit ever)
           - Allows us to create a new certificate in which we can specify an arbitrary subject alternative name(SAN) (likely of an admin or service account), which we can then use to change the password of another domain account with elevated privileges
           - Dump all certificates on a machine with certutil
           - Review the dumped certificates (or better yet, we should make a nice script to do it), looking for a couple of very specific things depending on the exact certificate template privilege escalation we want to use (can use certip-ad or certify to look for misconfigurations, but I have not tested these much yet)
           - Creating a new certificate using the GUI/CLI when/if we are able to find a suitable template
           - Using Rubeus to get a TGT using the service/admin account we specified in the certificate, the certificate file we downloaded, the certificate file password, and a couple of other basic pieces of information
           - Again using Rubeus, but this time to change the password of a domain admin using the TGT we just got
           - In some cases, we can relay NTLM authentication to the AD CS to create a certificate for an arbitrary user
           - If we encounter the 'ENROLL' permission set to 'Everyone' or 'Anonymous Logon', we can create a certificate for any account we know the username of - can check this by browsing to 'http://<target-ADCS>/certsrv' and seeing if the page loads
      
       - DLL Side-Loading
           - Windows uses a specific order of directories when searching for DLLs referenced in an executable
           - If Windows finds a DLL earlier in the search order, that is the one that is used, even if it's not the one the developer intended
           - Find services or executables running as SYSTEM, check if the directory it's in or other directories in the Windows search order are writeable, if so, put a malicious DLL in the directory that is searched earliest, trigger execution, DLL gets executed as SYSTEM
         
       - Scheduled Tasks (Windows version of Cron priv esc)
           - Dump and enumerate all scheduled tasks on a machine, focusing on those that run as SYSTEM/admin
           - Check permissions of the binary or script
           - Replace or modify the code to include malicious privilege escalation stuff
         
       - Stored Credentials, as we elevate privledges we have more ability to dump various stored credentials, doing this on all machines in a network, which can be a great way to further elevate

    - Token Impersonation   ****TODO****
    - Golden Ticket     ****TODO******
